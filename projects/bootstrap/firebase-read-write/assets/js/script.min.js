function bookOnload(){"/book.html"==window.location.pathname&&initBook()}async function initBook(){const o=getBookId();showBook(o,await fetchBook(o))}function getBookId(){const o=window.location.search.substring(1).split("&"),t={};return o.forEach(o=>{const e=(o=o.split("="))[0],a=o[1];t[e]=a}),t.id}async function fetchBook(o){null==o&&(window.location="/");const t=firebase.firestore();let e;try{e=(await t.collection("Notes").doc(o).get()).data()}catch(o){console.error(o)}return e}function showBook(o,t){$("#bookName").val(t.Book),$("#bookChapter").val(t.Chapter),$("#bookTags").text(t.Tags),$("#bookName").bind("input",e=>updateBook(o,t)),$("#bookChapter").bind("input",e=>updateBook(o,t)),$("#bookCard").removeClass("hide"),$("#loadingSpinner").addClass("hide")}function updateBook(o,t){firebase.firestore().collection("Notes").doc(o).set({Book:$("#bookName").val(),Chapter:$("#bookChapter").val(),Tags:t.Tags})}let documents=[];function firebaseOnload(){updateDocs()}async function updateDocs(){$("#cardGroup").addClass("hide"),$("#loadingSpinner").removeClass("hide"),documents=[];let o=firebase.firestore(),t=await o.collection("Notes").get();$("#cardGroup").empty(),t.forEach(o=>{const t=o.data();documents.push({id:o.id,data:t});var e=$(`\n      <div class="card">\n        <div class="card-body">\n          <h4 class="card-title"><span>${t.Book}</span><span style="color: rgba(255,255,255,0.59);font-size: 18px;margin-left: 16px;">${t.Chapter}</span></h4>\n          <h6 class="text-muted card-subtitle mb-2">${t.Tags}</h6>\n          <button class="btn btn-primary" role="button" onclick="openDoc('${o.id}')">Open</button>\n        </div>\n      </div>\n      `);$("#cardGroup").append(e)}),$("#cardGroup").removeClass("hide"),$("#loadingSpinner").addClass("hide")}function openDoc(o){window.location=window.location+"book.html?id="+o}async function addDoc(){db=firebase.firestore();try{await db.collection("Notes").add({Book:"Other Book"});updateDocs()}catch(o){console.error(o)}}async function changeDoc(o,t){db=firebase.firestore();try{await db.collection("Notes").doc(o).set({Book:t});updateDocs()}catch(o){console.error(o)}updateDocs()}async function removeFirstDoc(){db=firebase.firestore();try{await db.collection("Notes").doc(documents[0].id).delete();updateDocs()}catch(o){console.error(o)}}window.onload=()=>{window.location.pathname.includes("/book.html")?bookOnload():firebaseOnload()},window.onfocus=()=>{window.location.pathname.includes("/book.html")&&bookOnload()};